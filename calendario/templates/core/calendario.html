{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calendario Priorly</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.19/index.global.min.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="{% static 'core/calendario.css' %}?v=3" />
  </head>

  <body>
    <div id="calendar"></div>

    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.19/index.global.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var calendarEl = document.getElementById("calendar");
        var temas = JSON.parse("{{ temas_json|escapejs }}");

        var calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: "dayGridMonth",
          locale: "es",
          selectable: true,
          selectLongPressDelay: 0,
          firstDay: 1,
          navLinks: false,
          dayMaxEvents: true,
          moreLinkContent: "+más",

          headerToolbar: {
            left: "prev,next today",
            center: "title",
            right: "inicio",
          },

          customButtons: {
            inicio: {
              text: "Volver al inicio",
              click: function () {
                window.location.href = "{% url 'inicio' %}";
              },
            },
          },

          buttonText: {
            today: "Hoy",
            month: "Mes",
            week: "Semana",
            day: "Día",
          },

          allDaySlot: false,
          slotMinTime: "06:00:00",
          slotMaxTime: "22:00:00",
          events: temas,

          select: function (info) {
            var fechaSeleccionada = info.startStr;
            window.location.href =
              "/calendario/nuevo_tema/?fecha=" + fechaSeleccionada;
          },

          eventClick: function (info) {
            var id = info.event.id;
            window.location.href = "/calendario/editar_tema/" + id + "/";
          },

          eventTimeFormat: {
            hour: "2-digit",
            minute: "2-digit",
            hour12: false,
          },
        });
        calendar.render();
      });
    </script>
  </body>
</html>
